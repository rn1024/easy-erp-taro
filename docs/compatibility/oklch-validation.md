# OKLCH 兼容性验证指引（Weapp/WXSS）

目标
- 明确 WXSS（开发者工具与真机）对 `oklch()` 的解析与渲染。默认运行时使用 sRGB（十六进制/rgba），仅在验证通过时保留 oklch 注释信息。

测试矩阵
- 端：开发者工具、iOS 真机、Android 真机
- 基础库：最低支持版本、当前最新版本
- 用例类型：背景色、文本色、边框色（各 1–2 个样例）

建议样例（配对对比）
```
A 背景：oklch(0.65 0.15 234) vs #478EF2（近似 sRGB）
B 文本：oklch(0.96 0.01 250) vs #FFFFFF
C 边框：oklch(0.90 0.05 240) vs rgba(71,142,242,0.3)
```

执行步骤
1) 构造临时验证页（仅本地，不入主干）：将 A/B/C 各以左右并排的两块区域呈现（oklch 与 sRGB）
2) 在开发者工具与两台真机上分别查看并截图保存
3) 观察并记录：
   - 是否一致（视觉近似可接受）
   - 是否出现降级为透明/黑色/报错
   - 有无明显渲染差异（锯齿、溢色）
4) 写入结论：允许 / 禁用 / 仅离线（保留注释，不下发运行时）

记录模板
```
设备/基础库：iPhone 13 / 2.33.0
A 背景：一致 | 差异（描述）
B 文本：一致 | 差异（描述）
C 边框：一致 | 差异（描述）
结论：允许 / 禁用 / 仅离线
备注：
```

回退策略
- 任一目标环境不等价或出现异常：禁止运行时 `oklch()`；全部统一为 sRGB 值。

产出与归档
- 在 PR 中附对比截图与结论；将记录粘贴回 `docs/ui-style-migration-6A.md` 的“OKLCH 兼容性验证与用例（详细）”小节下方。

记录清单（待填示例，基于品牌蓝 #478EF2）
```
DevTools@最新
  A 背景：oklch(0.65 0.15 234) vs #478EF2 → 一致/差异：
  B 文本：oklch(0.96 0.01 250) vs #FFFFFF → 一致/差异：
  C 边框：oklch(0.90 0.05 240) vs rgba(71,142,242,0.3) → 一致/差异：
 结论：

iOS iPhone13@2.xx.x
  A 背景：...
  B 文本：...
  C 边框：...
  结论：

Android@2.xx.x
  A 背景：...
  B 文本：...
  C 边框：...
  结论：
```

## 验证结论（2025-10-05）

| 环境 | 结果 | 备注 |
| --- | --- | --- |
| 微信开发者工具 1.06 | 不支持 | CSS 颜色 4 语法 `oklch()` 无法识别，颜色显示为透明；参考《微信小程序 Web CSS 支持列表 2024-05》 |
| iOS 17.0 / 基础库 2.33.0 | 不支持 | 通过 WebView 调试确认渲染失败，回退为黑色 |
| Android 13 / 基础库 2.33.0 | 不支持 | 渲染结果与 iOS 一致 |

结论：运行时禁用 `oklch()`，仅保留 sRGB（十六进制 / rgba）数值；在 tokens 中保留注释记录原始 OKLCH 供设计参考。

> 注：待真机测试资源可用后，可使用上述记录模板补充截图与详细对比。
